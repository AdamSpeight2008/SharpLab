var app=angular.module("app",[]);app.filter("trim",[function(){return function(e){return e.trim()}}]),angular.module("app").controller("AppController",["$scope","$filter","$timeout","defaultsService","rememberService","urlService","compilationService","branches",function(e,r,t,n,o,a,i,c){"use strict";function s(e,r){var t=[],n=function(e){e&&e.forEach(function(e){t.push({severity:e.severity.toLowerCase(),message:e.message,from:CodeMirror.Pos(e.start.line,e.start.column),to:CodeMirror.Pos(e.end.line,e.end.column)})})};return n(e),n(r),t}function l(e){return function(r,t){return t!==r?e(r,t):void 0}}function u(){a.saveToUrl(e.code,e.options)}function p(r){if(void 0!==e.code&&""!==e.code&&!e.loading){r=r||function(){},e.loading=!0;var t=e.branch?e.branch.url:null;i.process(e.code,e.options,t).then(function(t){e.loading=!1,e.result=t,r(t)},function(t){e.loading=!1;var n=t.data,o=n.exceptionMessage||n.message;n.stackTrace&&(o+="\r\n"+n.stackTrace),e.result={success:!1,errors:[o]},r(e.result)})}}!function(){var r={language:"csharp",displayName:"C#"},t={language:"vbnet",displayName:"VB.NET"},n={language:"il",displayName:"IL"};e.languages=Object.freeze([r,t]),e.targets=Object.freeze([r,t,n]),e.codeMirrorModes=Object.freeze({csharp:"text/x-csharp",vbnet:"text/x-vb",il:""})}(),function(){e.branch=null,e.branches=c,e.branches.forEach(function(e){e.id=e.name.replace("/","-"),e.commits.forEach(function(e){e.date=new Date(e.date)})}),e.displayBranch=function(e){return e.name+" ("+r("date")(e.commits[0].date,"d MMM")+")"}}(),function(){var r=a.loadFromUrl()||{},t=r.options||o.load(),i=n.getOptions();t=angular.extend({},i,t),e.options=t,e.code=r.code||n.getCode(t.language),t.branch&&(e.branch=e.branches.filter(function(e){return e.id===t.branch})[0]||null,!e.branch&&t.branch&&(t.branch=null,u()))}(),function(){var r=l(function(){u(),o.save(e.options),p()});e.$watch("branch",l(function(r){e.options.branch=r?r.id:null}));for(var t in e.options)t.indexOf("$")>-1||e.$watch("options."+t,r)}(),e.process=function(r,t){e.code=r.getValue(),u(),p(function(e){t(r,s(e.errors,e.warnings))})}}]),angular.module("app").directive("appBooleanModel",function(){"use strict";function e(e,r,t,n){n.$parsers.push(function(e){return"true"===e}),n.$formatters.push(function(e){return e?"true":"false"})}return{restrict:"A",require:"ngModel",link:e}}),angular.module("app").directive("appCodemirror",function(){"use strict";function e(e,r,t){var n=r[0];n.value=e.value;var o=angular.extend({},e.$parent.$eval(t.options),void 0!==e.mode?{mode:e.mode}:{}),a=CodeMirror.fromTextArea(n,o);e.$watch("mode",function(e){a.setOption("mode",e)});var i=!1;e.$watch("value",function(e){e=void 0!=e?e:"",a.getValue()!==e&&(i=!0,a.setValue(e),i=!1)}),t.valueOneWay||a.on("change",function(){if(!i){var r=a.getValue();r!==e.value&&e.$apply(function(){e.value=r})}})}return{restrict:"E",replace:!0,template:"<textarea></textarea>",scope:{value:"=value",mode:"=mode"},link:e}}),angular.module("app").directive("appDiagnostic",function(){"use strict";return{restrict:"E",replace:!0,scope:{diagnostic:"=bind"},template:"<div>({{diagnostic.start.line}},{{diagnostic.start.column}},{{diagnostic.end.line}},{{diagnostic.end.column}}): {{diagnostic.severity}} {{diagnostic.id}}: {{diagnostic.message}}</div>"}}),angular.module("app").directive("appMobileCodemirrorFocus",[function(){"use strict";function e(e,r,t){var n=t.appMobileCodemirrorFocus;r.find(".CodeMirror").each(function(){this.CodeMirror.on("focus",function(){r.addClass(n)}),this.CodeMirror.on("blur",function(){r.removeClass(n)})})}return{restrict:"A",link:e}}]),angular.module("app").directive("appMobileShelf",["$window",function(e){"use strict";function r(e,r,n){var o=e.$eval(n.appMobileShelf),a=o.container?$(o.container):null,i=a||r;$(o.toggle).click(function(){i.toggleClass(o.openClass)}),a&&t(a[0]).on("swipeleft",function(){a.removeClass(o.openClass)}).on("swiperight",function(){a.addClass(o.openClass)})}var t=e.Hammer;return{restrict:"A",link:r}}]),angular.module("app").directive("appSyntaxtree",function(){"use strict";function e(e,t,n){e.root&&r(t,e.root),e.$watch("root",function(e){t.empty(),r(t,e)})}function r(e,t){var n=$("<li><span>"+t.kind+"</span></li>");if(t.nodes.length>0){n.addClass("with-children");var o=$("<ol>").appendTo(n);t.nodes.forEach(function(e){r(o,e)})}e.append(n)}return{restrict:"E",replace:!0,template:"<ol></ol>",scope:{root:"=root"},link:e}});var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(null==e)return"";var r,t,n,o,a,i,c,s="",l=0;for(e=LZString.compress(e);l<2*e.length;)l%2==0?(r=e.charCodeAt(l/2)>>8,t=255&e.charCodeAt(l/2),n=l/2+1<e.length?e.charCodeAt(l/2+1)>>8:NaN):(r=255&e.charCodeAt((l-1)/2),(l+1)/2<e.length?(t=e.charCodeAt((l+1)/2)>>8,n=255&e.charCodeAt((l+1)/2)):t=n=NaN),l+=3,o=r>>2,a=(3&r)<<4|t>>4,i=(15&t)<<2|n>>6,c=63&n,isNaN(t)?i=c=64:isNaN(n)&&(c=64),s=s+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(a)+LZString._keyStr.charAt(i)+LZString._keyStr.charAt(c);return s},decompressFromBase64:function(e){if(null==e)return"";var r,t,n,o,a,i,c,s,l="",u=0,p=0,d=LZString._f;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");p<e.length;)a=LZString._keyStr.indexOf(e.charAt(p++)),i=LZString._keyStr.indexOf(e.charAt(p++)),c=LZString._keyStr.indexOf(e.charAt(p++)),s=LZString._keyStr.indexOf(e.charAt(p++)),t=a<<2|i>>4,n=(15&i)<<4|c>>2,o=(3&c)<<6|s,u%2==0?(r=t<<8,64!=c&&(l+=d(r|n)),64!=s&&(r=o<<8)):(l+=d(r|t),64!=c&&(r=n<<8),64!=s&&(l+=d(r|o))),u+=3;return LZString.decompress(l)},compressToUTF16:function(e){if(null==e)return"";var r,t,n,o="",a=0,i=LZString._f;for(e=LZString.compress(e),r=0;r<e.length;r++)switch(t=e.charCodeAt(r),a++){case 0:o+=i((t>>1)+32),n=(1&t)<<14;break;case 1:o+=i(n+(t>>2)+32),n=(3&t)<<13;break;case 2:o+=i(n+(t>>3)+32),n=(7&t)<<12;break;case 3:o+=i(n+(t>>4)+32),n=(15&t)<<11;break;case 4:o+=i(n+(t>>5)+32),n=(31&t)<<10;break;case 5:o+=i(n+(t>>6)+32),n=(63&t)<<9;break;case 6:o+=i(n+(t>>7)+32),n=(127&t)<<8;break;case 7:o+=i(n+(t>>8)+32),n=(255&t)<<7;break;case 8:o+=i(n+(t>>9)+32),n=(511&t)<<6;break;case 9:o+=i(n+(t>>10)+32),n=(1023&t)<<5;break;case 10:o+=i(n+(t>>11)+32),n=(2047&t)<<4;break;case 11:o+=i(n+(t>>12)+32),n=(4095&t)<<3;break;case 12:o+=i(n+(t>>13)+32),n=(8191&t)<<2;break;case 13:o+=i(n+(t>>14)+32),n=(16383&t)<<1;break;case 14:o+=i(n+(t>>15)+32,(32767&t)+32),a=0}return o+i(n+32)},decompressFromUTF16:function(e){if(null==e)return"";for(var r,t,n="",o=0,a=0,i=LZString._f;a<e.length;){switch(t=e.charCodeAt(a)-32,o++){case 0:r=t<<1;break;case 1:n+=i(r|t>>14),r=(16383&t)<<2;break;case 2:n+=i(r|t>>13),r=(8191&t)<<3;break;case 3:n+=i(r|t>>12),r=(4095&t)<<4;break;case 4:n+=i(r|t>>11),r=(2047&t)<<5;break;case 5:n+=i(r|t>>10),r=(1023&t)<<6;break;case 6:n+=i(r|t>>9),r=(511&t)<<7;break;case 7:n+=i(r|t>>8),r=(255&t)<<8;break;case 8:n+=i(r|t>>7),r=(127&t)<<9;break;case 9:n+=i(r|t>>6),r=(63&t)<<10;break;case 10:n+=i(r|t>>5),r=(31&t)<<11;break;case 11:n+=i(r|t>>4),r=(15&t)<<12;break;case 12:n+=i(r|t>>3),r=(7&t)<<13;break;case 13:n+=i(r|t>>2),r=(3&t)<<14;break;case 14:n+=i(r|t>>1),r=(1&t)<<15;break;case 15:n+=i(r|t),o=0}a++}return LZString.decompress(n)},compress:function(e){if(null==e)return"";var r,t,n,o={},a={},i="",c="",s="",l=2,u=3,p=2,d="",f=0,h=0,g=LZString._f;for(n=0;n<e.length;n+=1)if(i=e.charAt(n),Object.prototype.hasOwnProperty.call(o,i)||(o[i]=u++,a[i]=!0),c=s+i,Object.prototype.hasOwnProperty.call(o,c))s=c;else{if(Object.prototype.hasOwnProperty.call(a,s)){if(s.charCodeAt(0)<256){for(r=0;p>r;r++)f<<=1,15==h?(h=0,d+=g(f),f=0):h++;for(t=s.charCodeAt(0),r=0;8>r;r++)f=f<<1|1&t,15==h?(h=0,d+=g(f),f=0):h++,t>>=1}else{for(t=1,r=0;p>r;r++)f=f<<1|t,15==h?(h=0,d+=g(f),f=0):h++,t=0;for(t=s.charCodeAt(0),r=0;16>r;r++)f=f<<1|1&t,15==h?(h=0,d+=g(f),f=0):h++,t>>=1}l--,0==l&&(l=Math.pow(2,p),p++),delete a[s]}else for(t=o[s],r=0;p>r;r++)f=f<<1|1&t,15==h?(h=0,d+=g(f),f=0):h++,t>>=1;l--,0==l&&(l=Math.pow(2,p),p++),o[c]=u++,s=String(i)}if(""!==s){if(Object.prototype.hasOwnProperty.call(a,s)){if(s.charCodeAt(0)<256){for(r=0;p>r;r++)f<<=1,15==h?(h=0,d+=g(f),f=0):h++;for(t=s.charCodeAt(0),r=0;8>r;r++)f=f<<1|1&t,15==h?(h=0,d+=g(f),f=0):h++,t>>=1}else{for(t=1,r=0;p>r;r++)f=f<<1|t,15==h?(h=0,d+=g(f),f=0):h++,t=0;for(t=s.charCodeAt(0),r=0;16>r;r++)f=f<<1|1&t,15==h?(h=0,d+=g(f),f=0):h++,t>>=1}l--,0==l&&(l=Math.pow(2,p),p++),delete a[s]}else for(t=o[s],r=0;p>r;r++)f=f<<1|1&t,15==h?(h=0,d+=g(f),f=0):h++,t>>=1;l--,0==l&&(l=Math.pow(2,p),p++)}for(t=2,r=0;p>r;r++)f=f<<1|1&t,15==h?(h=0,d+=g(f),f=0):h++,t>>=1;for(;;){if(f<<=1,15==h){d+=g(f);break}h++}return d},decompress:function(e){if(null==e)return"";if(""==e)return null;var r,t,n,o,a,i,c,s,l=[],u=4,p=4,d=3,f="",h="",g=LZString._f,v={string:e,val:e.charCodeAt(0),position:32768,index:1};for(t=0;3>t;t+=1)l[t]=t;for(o=0,i=Math.pow(2,2),c=1;c!=i;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=32768,v.val=v.string.charCodeAt(v.index++)),o|=(a>0?1:0)*c,c<<=1;switch(r=o){case 0:for(o=0,i=Math.pow(2,8),c=1;c!=i;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=32768,v.val=v.string.charCodeAt(v.index++)),o|=(a>0?1:0)*c,c<<=1;s=g(o);break;case 1:for(o=0,i=Math.pow(2,16),c=1;c!=i;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=32768,v.val=v.string.charCodeAt(v.index++)),o|=(a>0?1:0)*c,c<<=1;s=g(o);break;case 2:return""}for(l[3]=s,n=h=s;;){if(v.index>v.string.length)return"";for(o=0,i=Math.pow(2,d),c=1;c!=i;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=32768,v.val=v.string.charCodeAt(v.index++)),o|=(a>0?1:0)*c,c<<=1;switch(s=o){case 0:for(o=0,i=Math.pow(2,8),c=1;c!=i;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=32768,v.val=v.string.charCodeAt(v.index++)),o|=(a>0?1:0)*c,c<<=1;l[p++]=g(o),s=p-1,u--;break;case 1:for(o=0,i=Math.pow(2,16),c=1;c!=i;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=32768,v.val=v.string.charCodeAt(v.index++)),o|=(a>0?1:0)*c,c<<=1;l[p++]=g(o),s=p-1,u--;break;case 2:return h}if(0==u&&(u=Math.pow(2,d),d++),l[s])f=l[s];else{if(s!==p)return null;f=n+n.charAt(0)}h+=f,l[p++]=n+f.charAt(0),u--,n=f,0==u&&(u=Math.pow(2,d),d++)}}};"undefined"!=typeof module&&null!=module&&(module.exports=LZString),angular.module("app").service("compilationService",["$http",function(e){"use strict";this.process=function(r,t,n){var o="api/compilation";n&&(o=n.replace(/\/?$/,"/")+o);var a={code:r};return angular.extend(a,t),e({url:o,method:"POST",data:a,headers:{"Content-Type":"application/json",Accepts:"application/json"}}).then(function(e){return e.data})}}]),angular.module("app").service("defaultsService",[function(){"use strict";var e={csharp:"using System;\r\npublic class C {\r\n    public void M() {\r\n    }\r\n}",vbnet:"Imports System\r\nPublic Class C\r\n    Public Sub M()\r\n    End Sub\r\nEnd Class"};this.getOptions=function(){return{branch:null,language:"csharp",target:"csharp",mode:"regular",optimizations:!1}},this.getCode=function(r){return e[r]}}]),angular.module("app").service("$location",["$window","$rootScope",function(e,r){"use strict";["absUrl","url","protocol","host","port","path","search","replace"].forEach(function(e){this[e]=function(){throw new Error("Not implemented: "+e+".")}},this),this.hash=function(r){return void 0!==r&&(e.location.hash=r),e.location.hash},e.addEventListener("hashchange",function(){r.$emit("$locationChangeSuccess")},!1)}]),angular.module("app").service("rememberService",[function(){"use strict";this.load=function(){var e=localStorage["tryroslyn.options"];return e?e=JSON.parse(e):null},this.save=function(e){localStorage["tryroslyn.options"]=JSON.stringify(e)}}]),angular.module("app").service("urlService",["$location","$rootScope",function(e,r){"use strict";function t(r){var t=e.hash();if(!t)return null;if(t=t.replace(/^#/,""),!t||r&&t===a)return null;a=t;var n=/(?:b:([^\/]+)\/)?(?:f:([^\/]+)\/)?(.+)/.exec(t);if(null===n)return null;var i={options:angular.extend({branch:n[1]},o(n[2]))};try{i.code=LZString.decompressFromBase64(n[3])}catch(c){return null}return i}function n(e){return["vbnet"===e.language?"vb":"",i[e.target],"script"===e.mode?"s":"",e.optimizations?"r":""].join("")}function o(e){if(!e)return{};var r=c[""];for(var t in c)""!==t&&e.indexOf(t)>-1&&(r=c[t]);return{language:/(^|[a-z])vb/.test(e)?"vbnet":"csharp",target:r,mode:e.indexOf("s")>-1?"script":"regular",optimizations:e.indexOf("r")>-1}}var a;this.saveToUrl=function(r,t){var o=LZString.compressToBase64(r),i=n(t);i&&(o="f:"+i+"/"+o),t.branch&&(o="b:"+t.branch+"/"+o),a=o,e.hash(o)},this.loadFromUrl=t.bind(this,!1),this.onUrlChange=function(e){r.$on("$locationChangeSuccess",function(){var r=t(!0);null!==r&&e(r)})};var i={csharp:"",vbnet:">vb",il:">il"},c=function(){var e={};for(var r in i)e[i[r]]=r;return e}()}]);